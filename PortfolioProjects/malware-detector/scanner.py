import yara 
import sys 
import os 

def scan_file(file_path, rule_path):
    if not os.path.isfile(file_path):
        print("file not found")
        return 
    
    rules = yara.compile(filepath=rule_path)
    matches = rules.match(filepath=file_path)

    if matches:
        print("Suspicious patterns found:")
        for match in matches:
            print(f" - Rule: {match.rule}")
    else:
        print("No suspicious patterns found.")
    print("scanning:", file_path)
    print("Rule File:", rule_path)

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python scanner.py <file_path> <rule_path>")

    else:
        scan_file(sys.argv[1], sys.argv[2])